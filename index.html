<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SISA Form</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    body, form, input, select, button, label { font-family: 'Poppins', sans-serif; }
    form { max-width: 600px; margin: auto; }
    label { font-weight: normal; margin-bottom: 5px; }
    input[type="text"], input[type="email"], select {
      padding: 10px 12px; border: 1px solid #ccc; border-radius: 5px;
      font-size: 14px; width: 100%; box-sizing: border-box; height: 42px;
    }
    input[type="checkbox"] { transform: scale(1.2); cursor: pointer; margin-right: 5px; }
    button[type="submit"] { background-color: #0073e6; color: white; border: none; padding: 12px 24px; border-radius: 25px; font-size: 16px; cursor: pointer; transition: background 0.3s ease; }
    button[type="submit"]:hover { background-color: #005bb5; }
    .row { display: flex; gap: 15px; margin-bottom: 20px; }
    .row > div { flex: 1; display: flex; flex-direction: column; }
    .checkbox { display: flex; align-items: center; margin: 15px 0; }
    .terms { font-size: 12px; color: #555; margin-bottom: 15px; }
  </style>
</head>
<body>
  <form id="sisaForm" method="post">
    <div class="row">
      <div>
        <label>First Name *</label>
        <input type="text" name="First" required placeholder="First">
      </div>
      <div>
        <label>Last Name *</label>
        <input type="text" name="Last" required placeholder="Last">
      </div>
    </div>

    <div class="row">
      <div>
        <label>Organization *</label>
        <input type="text" name="Organization" required placeholder="Organization Name">
      </div>
      <div>
        <label>Work Email *</label>
        <input type="email" name="Work Email" required placeholder="Work Email">
      </div>
    </div>

    <div class="row">
      <div>
        <label>Contact No.</label>
        <input type="text" name="Contact No." placeholder="Contact No.">
      </div>
      <div>
        <label>Country *</label>
        <select name="Country" required>
          <option value="">Choose one</option>
          <option value="India">India</option>
          <option value="United States">United States</option>
          <!-- add other countries as needed -->
        </select>
      </div>
    </div>

    <!-- Hidden fields for Pardot -->
    <input type="hidden" name="utm_source" id="utm_source" value="">
    <input type="hidden" name="Business Unit" id="business_unit" value=""> <!-- optional -->

    <div class="checkbox">
      <input type="checkbox" name="opt_in" value="true">
      <label>I'm looking forward to receiving emails and newsletters from SISA</label>
    </div>

    <p class="terms">
      By submitting this form, I agree to the 
      <a href="https://www.sisainfosec.com/terms-of-use/" target="_blank">Website Terms of Conditions</a> 
      and the <a href="https://www.sisainfosec.com/privacy-policy/" target="_blank">SISA Privacy Policy</a>.
    </p>

    <button type="submit">Submit</button>
  </form>

  <script>
    (function() {
      const params = new URLSearchParams(window.location.search);

      // 1️⃣ Set UTM Source dynamically from iframe URL
      const asset = params.get("asset");
      if (asset) {
        document.getElementById("utm_source").value = decodeURIComponent(asset);
      }

      // 2️⃣ Set endpoint dynamically from iframe URL
      const endpoint = params.get("endpoint");
      if (endpoint) document.getElementById("sisaForm").action = decodeURIComponent(endpoint);
      else console.warn("⚠️ No endpoint provided, form action not set!");

      // 3️⃣ Redirect to thank you page after submit
      const thankyou = params.get("thankyou");
      document.getElementById("sisaForm").addEventListener("submit", function() {
        setTimeout(function() {
          if (thankyou) {
            if (window.location !== window.parent.location) {
              window.parent.location.href = decodeURIComponent(thankyou);
            } else {
              window.location.href = decodeURIComponent(thankyou);
            }
          }
        }, 1500); // short delay
      });
    })();
  </script>
</body>
</html>
